-- MySQL Script generated by MySQL Workbench
-- Tue Oct 24 19:19:15 2017
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema osdb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema osdb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `osdb` DEFAULT CHARACTER SET utf8 ;
USE `osdb` ;

-- -----------------------------------------------------
-- Table `osdb`.`cliente`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `osdb`.`cliente` (
  `idcliente` INT NOT NULL AUTO_INCREMENT,
  `nome_cliente` VARCHAR(45) NOT NULL,
  `email_cliente` VARCHAR(45) NULL,
  `cpf_cliente` VARCHAR(11) NULL,
  `contato_cliente` VARCHAR(11) NOT NULL,
  `contato2_cliente` VARCHAR(11) NULL,
  `rua_cliente` VARCHAR(30) NOT NULL,
  `numero_cliente` INT NOT NULL,
  `complemento_cliente` VARCHAR(15) NULL,
  `bairro_cliente` VARCHAR(15) NOT NULL,
  `cidade_cliente` VARCHAR(20) NOT NULL,
  `cep_cliente` VARCHAR(8) NULL,
  `estado_cliente` VARCHAR(2) NOT NULL,
  PRIMARY KEY (`idcliente`),
  UNIQUE INDEX `idclientes_UNIQUE` (`idcliente` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `osdb`.`funcionario`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `osdb`.`funcionario` (
  `idfuncionario` INT NOT NULL AUTO_INCREMENT,
  `nome` VARCHAR(45) NOT NULL,
  `email` VARCHAR(45) NOT NULL,
  `contato` VARCHAR(11) NOT NULL,
  `contato2` VARCHAR(11) NULL,
  `usuario` VARCHAR(15) NOT NULL,
  `senha` VARCHAR(32) NOT NULL,
  `adm` INT NULL COMMENT '1=administrador, 0=nao administrador',
  PRIMARY KEY (`idfuncionario`),
  UNIQUE INDEX `idfuncionarios_UNIQUE` (`idfuncionario` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `osdb`.`os`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `osdb`.`os` (
  `idos` INT NOT NULL AUTO_INCREMENT,
  `descricao` VARCHAR(150) NULL,
  `equipamento` VARCHAR(80) NULL,
  `imagem` VARCHAR(100) NULL COMMENT 'imagem do equipamento',
  `dataabertura` DATE NULL,
  `status` INT NOT NULL COMMENT '0=aberta, 1= em analise, 2=aguardando aprovação de orçamento, 3=orçamento aprovado, 4=em reparo, 5=pronto para entrega/retirada, 6=finalizado',
  `datafechamento` DATE NULL,
  `cliente_idcliente` INT NOT NULL,
  `funcionario_idfuncionario` INT NOT NULL,
  PRIMARY KEY (`idos`, `cliente_idcliente`, `funcionario_idfuncionario`),
  UNIQUE INDEX `idos_UNIQUE` (`idos` ASC),
  INDEX `fk_os_clientes_idx` (`cliente_idcliente` ASC),
  INDEX `fk_os_funcionarios1_idx` (`funcionario_idfuncionario` ASC),
  CONSTRAINT `fk_os_clientes`
    FOREIGN KEY (`cliente_idcliente`)
    REFERENCES `osdb`.`cliente` (`idcliente`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_os_funcionarios1`
    FOREIGN KEY (`funcionario_idfuncionario`)
    REFERENCES `osdb`.`funcionario` (`idfuncionario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `osdb`.`acompanhamento`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `osdb`.`acompanhamento` (
  `idacompanhamento` INT NOT NULL AUTO_INCREMENT,
  `descricao_acompanhamento` VARCHAR(200) NULL,
  `data_acompanhamento` DATE NULL,
  `os_idos` INT NOT NULL,
  `funcionario_idfuncionario` INT NOT NULL,
  PRIMARY KEY (`idacompanhamento`, `os_idos`, `funcionario_idfuncionario`),
  INDEX `fk_acompanhamento_os1_idx` (`os_idos` ASC),
  INDEX `fk_acompanhamento_funcionario1_idx` (`funcionario_idfuncionario` ASC),
  CONSTRAINT `fk_acompanhamento_os1`
    FOREIGN KEY (`os_idos`)
    REFERENCES `osdb`.`os` (`idos`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_acompanhamento_funcionario1`
    FOREIGN KEY (`funcionario_idfuncionario`)
    REFERENCES `osdb`.`funcionario` (`idfuncionario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

INSERT INTO `cliente` (`idcliente`, `nome_cliente`, `email_cliente`, `cpf_cliente`, `contato_cliente`, `contato2_cliente`, `rua_cliente`, `numero_cliente`, `complemento_cliente`, `bairro_cliente`, `cidade_cliente`, `cep_cliente`, `estado_cliente`) VALUES
(1, 'Cliente Primeiro Silva', 'huehue@hotmail.com', '11111111', '33999991111', '33999991111', 'Rua tal tal tal', 547, 'Ap 304', 'Sao jacinto', 'Teofilo Otoni', '00000000', 'MG'),
(2, 'Segundo Cliente Teste', 'huehue@hotmail.com', '22222222', '33999991111', '33999991111', 'Rua teste teste', 2134, 'Ap 101', 'Sabta Rita', 'Belo Horizonte', '22222222', 'MG'),
(3, 'Terceiro Cliente Teste ', 'test@email.com', '33333333', '33999991111', NULL, 'Rua teste de tal', 51, 'casa', 'Centro', 'Porto Seguro', NULL, 'BA'),
(4, 'Cliente Cinco Da Silva', 'huehue@hotmail.com', '4444444', '33999991111', '33999991111', 'Rua sete de setembro', 33, 'casa', 'Santa Rita', 'Franciscopolis', '', 'MG'),
(5, 'Ultimo Cliente do Sistema', 'nha@hotmail.com', '555555', '3399999999', '', 'Rua teste da sil', 22, '', 'Centro', 'Teofilo Otoni', '12345678', 'MG');

INSERT INTO `funcionario` (`idfuncionario`, `nome`, `email`, `contato`, `contato2`, `usuario`, `senha`, `adm`) VALUES
(1, 'Admin', 'admin@admin.com', '00000000000', '00000000000', 'admin', '21232f297a57a5a743894a0e4a801fc3', 1),
(2, 'Jose', 'ml@admin.com', '33900000000', '', 'teste', '21232f297a57a5a743894a0e4a801fc3', 1),
(3, 'Wender C', 'wc@admin.com', '33900000000', '', 'wender', '21232f297a57a5a743894a0e4a801fc3', 0),
(4, 'Angelo G', 'ag@admin.com', '33900000000', '', 'angelo', '21232f297a57a5a743894a0e4a801fc3', 1),
(5, 'Edson G', 'ed@admin.com', '33900000000', '', 'edson', '21232f297a57a5a743894a0e4a801fc3', 0),
(6, 'Wesley C', 'wes@admin.com', '33900000000', '', 'wesley', '21232f297a57a5a743894a0e4a801fc3', 1),
(7, 'Amaury G', 'am@admin.com', '33900000000', '', 'amaury', '21232f297a57a5a743894a0e4a801fc3', 1);

INSERT INTO `os` (`idos`, `descricao`, `equipamento`, `imagem`, `dataabertura`, `status`, `datafechamento`, `cliente_idcliente`, `funcionario_idfuncionario`) VALUES
(1, 'teste descricao da ordem de serviço 11', 'equipamento 1', NULL, '2017-09-28', 0, NULL, 1, 1),
(2, 'teste descricao da ordem de serviço 22', 'equipamento 2', NULL, '2017-09-29', 0, NULL, 2, 1),
(3, 'teste descricao da ordem de serviço 33', 'equipamento 3', NULL, '2017-10-03', 2, NULL, 1, 7),
(4, 'teste descricao da ordem de serviço 44', 'equipamento 4', NULL, '2017-10-05', 3, NULL, 3, 6),
(5, 'teste descricao da ordem de serviço 55', 'equipamento 5', NULL, '2017-10-07', 4, NULL, 2, 1),
(6, 'teste descricao da ordem de serviço 66', 'equipamento 6', NULL, '2017-10-11', 6, NULL, 2, 1);

INSERT INTO `acompanhamento` (`idacompanhamento`, `descricao_acompanhamento`, `data_acompanhamento`, `os_idos`, `funcionario_idfuncionario`) VALUES
(1, 'acompanhamento teste 11111 1111', '2017-09-28', 1, 3),
(2, 'acompanhamento teste 22222 2222', '2017-09-29', 2, 3),
(3, 'acompanhamento teste 22222 2222', '2017-09-30', 5, 1),
(4, 'acompanhamento teste 22222 2222', '2017-10-05', 3, 2),
(5, 'acompanhamento teste 22222 2222', '2017-10-08', 1, 4);

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
